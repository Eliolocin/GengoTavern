/* Import ReactCrop styles */
@import "react-image-crop/dist/ReactCrop.css";

/* Reset and Base Styles */
body,
html {
	margin: 0;
	padding: 0;
	height: 100%;
	overflow: hidden;
}

/* General Layout */
.app-container {
	position: relative;
	height: 100vh;
	width: 100vw;
	color: #fff;
	overflow: hidden;
	display: flex;
	justify-content: center;
	background-color: #121212; /* Fallback if no background image */
}

/* Application backdrop for semi-transparency */
.app-backdrop {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background-color: rgba(18, 18, 18, 0.2); /* Semi-transparent overlay */
	z-index: 0;
}

/* Fixed Center Chat Pane */
.chat-pane {
	width: 60vw;
	height: 100vh;
	position: fixed;
	left: 50%;
	transform: translateX(-50%);
	z-index: 1;
	display: flex;
	flex-direction: column;
	padding: 20px;
	box-sizing: border-box;
	/*backdrop-filter: blur(5px);  Apply blur effect */
}

/* Responsive Layout - Switch to Full Width at 768px */
@media screen and (max-width: 768px) {
	.chat-pane {
		width: 100vw;
		padding: 15px; /* Reduce padding on mobile */
	}

	.side-panel {
		display: block;
	}

	.collapse-button.vertical {
		display: block;
	}
}

/* Side Panels - Attached Directly to Body */
.side-panel {
	position: fixed;
	top: 0;
	height: 100vh;
	background-color: rgba(30, 30, 30, 0.95); /* Increase opacity for better readability */
	backdrop-filter: blur(8px); /* Apply stronger blur effect */
	border: none;
	overflow: hidden;
	z-index: 2;
	transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
	will-change: transform;
}

/* Left Panel */
.left-panel {
	left: 0;
	width: 20vw;
	transform: translateX(calc(-100% + 40px));
}

.left-panel.expanded {
	transform: translateX(0);
}

.left-panel.collapsed {
	transform: translateX(calc(-100% + 40px));
}

/* Right Panel */
.right-panel {
	right: 0;
	width: 20vw;
	transform: translateX(calc(100% - 40px));
}

.right-panel.expanded {
	transform: translateX(0);
}

.right-panel.collapsed {
	transform: translateX(calc(100% - 40px));
}

/* Collapse Buttons - Fixed Vertical Bars */
.collapse-button.vertical {
	position: absolute;
	top: 0;
	width: 40px;
	height: 100%;
	background-color: #333;
	color: #fff;
	border: none;
	cursor: pointer;
	z-index: 3;
	transition: background-color 0.2s ease;
}

.collapse-button.vertical:hover {
	background-color: #444;
}

/* Left Collapse Button */
.collapse-button.vertical.left {
	right: 0;
}

/* Right Collapse Button */
.collapse-button.vertical.right {
	left: 0;
}

/* Pane Content */
.side-panel .pane-content {
	height: 100%;
	width: calc(100% - 40px);
	padding: 20px;
	box-sizing: border-box;
	overflow-y: auto;
	background-color: #1e1e1e;
	opacity: 1;
	transition: opacity 0.3s ease;
}

/* Left Panel Content */
.left-panel .pane-content {
	margin-right: 40px;
}

.left-panel.collapsed .pane-content {
	opacity: 0;
}

/* Right Panel Content - Improve padding and alignment */
.right-panel .pane-content {
	margin-left: 40px;
	padding: 20px;
	padding-right: 25px; /* Add extra padding on the right side */
	box-sizing: border-box;
	max-width: 100%;
}

.right-panel.collapsed .pane-content {
	opacity: 0;
}

/* Character Grid */
.character-grid {
	display: grid;
	grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
	gap: 15px;
}

.character-tile {
	background-color: #2a2a2a;
	display: flex;
	align-items: center;
	justify-content: center;
	padding: 8px;
	border: none;
	border-radius: 6px;
	cursor: pointer;
	transition: transform 0.2s ease, background-color 0.2s ease;
	position: relative;
	overflow: hidden;
	/* Maintain 2:3 aspect ratio */
	aspect-ratio: 2 / 3;
	width: 100%;
}

.character-tile.selected {
	border: 2px solid #646cff;
	transform: scale(1.05);
}

.character-tile:hover {
	background-color: #333;
	transform: scale(1.05);
}

.character-tile img {
	width: 100%;
	height: 100%;
	object-fit: cover;
	border-radius: 4px;
	will-change: transform;
}

.plus-sign {
	font-size: 2.5rem;
	font-weight: bold;
	color: #666;
}

/* Character Actions */
.character-actions {
	margin-bottom: 20px;
}

.import-button {
	width: 100%;
	padding: 10px;
	background-color: rgba(100, 108, 255, 0.7);
	color: #fff;
	border: none;
	border-radius: 4px;
	cursor: pointer;
	transition: background-color 0.2s ease;
}

.import-button:hover {
	background-color: #444;
}

/* Chat Components */
.chat-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: 15px;
	border-radius: 6px;
	margin-bottom: 15px;
	background-color: rgba(18, 18, 18, 0.6); /* Added background color */
	z-index: 3; /* Higher than visual novel elements */
	position: relative;
}

.chat-header h2 {
	margin: 0;
	flex-grow: 1;
}

.chat-header-actions {
	display: flex;
	gap: 8px;
	margin-right: 15px;
}

.header-action-button {
	width: 36px;
	height: 36px;
	display: flex;
	align-items: center;
	justify-content: center;
	border-radius: 50%;
	background-color: rgba(58, 58, 58, 0.7);
	color: #fff;
	border: none;
	font-size: 16px;
	cursor: pointer;
	transition: background-color 0.2s ease;
}

.header-action-button:hover {
	background-color: rgba(100, 108, 255, 0.5);
}

.help-button {
	font-weight: bold;
}

.persona-button,
.api-button {
	font-size: 18px;
}

.chat-messages {
	flex: 1;
	overflow-y: auto;
	padding: 15px;
	background-color: rgba(18, 18, 18, 0.6); /* Changed from rgba(0, 0, 0, 0.4) to match chat-pane */
	border-radius: 6px;
	margin: 15px 0;
	display: flex;
	flex-direction: column;
	gap: 15px;
}

.empty-chat {
	display: flex;
	align-items: center;
	justify-content: center;
	height: 100%;
	color: #666;
	font-style: italic;
}

.message {
	display: flex;
	gap: 10px;
	max-width: 80%;
	position: relative;
}

.user-message {
	align-self: flex-end;
	flex-direction: row-reverse;
}

.character-message {
	align-self: flex-start;
}

.character-avatar-container {
	width: 80px;
	height: 80px;
	flex-shrink: 0;
}

.message-avatar {
	width: 100%;
	height: 100%;
	border-radius: 50%;
	object-fit: cover;
}

/* Message content - fix message layout */
.message-content {
	background-color: #2a2a2a;
	padding: 10px 15px;
	padding-top: 35px; /* Increase space at top for name */
	border-radius: 8px;
	position: relative;
	z-index: 1;
	min-height: 70px; /* Minimum height to prevent overlap */
	min-width: 200px; /* Ensure minimum width for better spacing */
	display: flex;
	flex-direction: column;
}

.user-message .message-content {
	background-color: #3a3a3a;
	padding-top: 35px;
}

.message-text {
	margin-bottom: 5px;
	white-space: pre-wrap;
	word-break: break-word;
	flex: 1; /* Allow text to grow and fill space */
}

.message-timestamp {
	font-size: 0.75rem;
	color: #999;
	text-align: right;
	margin-bottom: 0; /* Remove bottom margin */
	align-self: flex-end; /* Align to right edge */
}

/* Fix action positioning */
.message-actions {
	position: absolute;
	top: 5px;
	display: flex;
	gap: 5px;
	transition: opacity 0.2s ease;
	opacity: 0.7;
	z-index: 2;
}

.user-message .message-actions {
	left: 10px; /* Increase left padding */
}

.character-message .message-actions {
	right: 10px; /* Increase right padding */
}

/* Fix sender name positioning */
.message-sender {
	position: absolute;
	top: 8px;
	font-size: 12px;
	font-weight: bold;
	opacity: 0.8;
	z-index: 2;
	max-width: 50%; /* Prevent long names from overlapping */
	overflow: hidden;
	text-overflow: ellipsis;
	white-space: nowrap;
}

.user-message .message-sender {
	right: 10px; /* Increase right padding */
	left: auto;
	color: #a0c0ff;
}

.character-message .message-sender {
	left: 10px; /* Increase left padding */
	color: #a0ffc0;
}

.message-text {
	margin-bottom: 5px;
	white-space: pre-wrap;
	word-break: break-word;
}

.message-timestamp {
	font-size: 0.75rem;
	color: #999;
	text-align: right;
}

.message-actions {
	position: absolute;
	top: 5px;
	display: flex;
	gap: 5px;
	transition: opacity 0.2s ease;
	opacity: 0.7; /* Semi-transparent by default */
	z-index: 2; /* Ensure it's above the message text */
}

.message-actions.visible {
	opacity: 0.7; /* Always visible but semi-transparent */
}

.user-message .message-actions {
	left: 8px; /* Position on the left for user messages */
	right: auto; /* Reset right positioning */
}

.character-message .message-actions {
	right: 5px;
}

.message:hover .message-actions {
	opacity: 1; /* Full opacity on hover */
}

.message-action {
	padding: 3px;
	min-width: 24px;
	height: 24px;
	display: flex;
	align-items: center;
	justify-content: center;
	background-color: transparent;
	color: #999;
	border: none;
	border-radius: 4px;
	cursor: pointer;
	transition: background-color 0.2s ease, color 0.2s ease;
}

.message-action:hover {
	background-color: rgba(255, 255, 255, 0.1);
	color: #fff;
}

.message-action.continue-button {
	font-size: 18px;
	font-weight: bold;
	padding-bottom: 8px; /* Adjust vertical position of the ellipsis */
}

.chat-input {
	display: flex;
	padding: 10px;
	background-color: rgba(18, 18, 18, 0.6); /* Changed from rgba(42, 42, 42, 0.8) to match chat-pane */
	border-radius: 8px;
	z-index: 3; /* Higher than visual novel elements */
	position: relative;
}

.chat-input-container {
	display: flex;
	flex-direction: column;
	gap: 10px;
	width: 100%;
	margin-bottom: 10px;
}

.vn-mode-toggle-container {
	display: flex;
	justify-content: center;
	width: 100%;
}

.vn-mode-toggle-button {
	background-color: #2c3e50;
	color: white;
	border: none;
	border-radius: 20px;
	padding: 8px 16px;
	cursor: pointer;
	font-size: 14px;
	transition: background-color 0.3s ease, transform 0.2s ease;
	box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
	display: flex;
	align-items: center;
	justify-content: center;
}

.vn-mode-toggle-button:hover {
	background-color: #34495e;
	transform: translateY(-2px);
}

.vn-mode-toggle-button.active {
	background-color: #e74c3c;
}

.vn-mode-toggle-button.active:hover {
	background-color: #c0392b;
}

.chat-input textarea {
	flex: 1;
	padding: 12px;
	border: none;
	border-radius: 6px;
	background-color: #2a2a2a;
	color: #fff;
	resize: none;
	min-height: 24px;
	max-height: 150px;
	overflow-y: auto;
	font-family: inherit;
	font-size: inherit;
	line-height: 1.5;
}

.chat-input button {
	padding: 12px 24px;
	border: none;
	border-radius: 6px;
	cursor: pointer;
	background-color: #333;
	color: #fff;
	transition: background-color 0.2s ease;
	align-self: flex-end;
}

.chat-input button:hover {
	background-color: #444;
}

/* Chat Item Styles */
.chat-list {
	margin-top: 15px;
	max-height: 200px;
	overflow-y: auto;
}

.chat-item {
	padding: 10px;
	margin-bottom: 8px;
	background-color: #2a2a2a;
	border-radius: 4px;
	cursor: pointer;
	transition: background-color 0.2s ease;
}

.chat-item.active {
	background-color: #3a3a3a;
	border-left: 3px solid #646cff;
}

.chat-item:hover {
	background-color: #333;
}

/* Loading and Error States */
.loading,
.error {
	display: flex;
	align-items: center;
	justify-content: center;
	height: 100vh;
	width: 100vw;
	background-color: #121212;
	color: #fff;
}

.error {
	color: #ff6b6b;
}

/* Form Styles */
.character-form-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
}

.delete-character-button {
	padding: 5px 10px;
	background-color: #ff4d4f;
	color: white;
	border: none;
	border-radius: 4px;
	cursor: pointer;
}

.delete-character-button:hover {
	background-color: #ff7875;
}

.form-actions {
	margin: 15px 0;
	display: flex;
	justify-content: center;
	gap: 10px; /* Add gap between buttons */
}

.save-character-button {
	padding: 8px 16px;
	background-color: #4caf50;
	color: white;
	border: none;
	border-radius: 4px;
	cursor: pointer;
}

.save-character-button:hover {
	background-color: #66bb6a;
}

.manage-sprites-button {
	background-color: #2196f3;
	color: white;
	border: none;
	border-radius: 4px;
	padding: 8px 16px;
	cursor: pointer;
	font-size: 14px;
	margin-left: 10px;
	transition: background-color 0.3s ease;
}

.manage-sprites-button:hover {
	background-color: #0d8bf2;
}

.save-json-button {
	padding: 8px 16px;
	background-color: #2196f3; /* Blue color for JSON button */
	color: white;
	border: none;
	border-radius: 4px;
	cursor: pointer;
}

.save-json-button:hover {
	background-color: #42a5f5;
}

.form-group {
	margin-bottom: 20px;
	padding-right: 5px; /* Add consistent padding */
}

.avatar-upload-overlay {
	position: absolute;
	bottom: 0;
	left: 0;
	right: 0;
	background: rgba(0, 0, 0, 0.7);
	display: flex;
	justify-content: center;
	padding: 8px;
	opacity: 0;
	transition: opacity 0.2s;
}

.character-avatar-wrapper {
	position: relative;
	overflow: hidden;
	/* Fixed dimensions for better control */
	width: 140px;
	height: 210px; /* 2:3 ratio */
	margin: 0 auto 25px;
	border-radius: 8px;
	box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
}

.character-avatar {
	width: 100%;
	height: 100%;
	object-fit: cover;
	object-position: center top; /* Position from top for face visibility */
}

.character-avatar-wrapper:hover .avatar-upload-overlay {
	opacity: 1;
}

.upload-button {
	background: #4caf50;
	color: white;
	padding: 5px 10px;
	border-radius: 4px;
	cursor: pointer;
}

.hidden-input {
	display: none;
}

.dialogue-pair-container {
	display: flex;
	align-items: center;
	gap: 5px;
	margin-bottom: 10px;
	padding-right: 35px; /* Increase space for the delete button */
	position: relative; /* Add position relative */
}

.dialogue-pair {
	display: flex;
	flex-direction: column;
	width: 100%;
	gap: 5px;
}

/* Adjust sample dialogue inputs to take full width */
.dialogue-pair .editable-field {
	width: 100%;
}

.dialogue-pair .editable-field input {
	width: 100%;
}

/* Delete button for sample dialogues - Ensure it appears above inputs */
.remove-dialogue {
	padding: 0;
	width: 30px;
	height: 30px;
	min-width: 30px;
	border-radius: 50%;
	display: flex;
	align-items: center;
	justify-content: center;
	background-color: #ff4d4f;
	flex-shrink: 0;
	position: absolute; /* Position absolute */
	right: 0; /* Position on the right */
	top: 50%; /* Center vertically */
	transform: translateY(-50%); /* Center vertically */
	z-index: 3; /* Ensure it's above the inputs */
}

.remove-dialogue:disabled {
	background-color: #666;
	cursor: not-allowed;
}

.add-dialogue {
	margin-top: 10px;
	background-color: #1890ff;
	color: white;
}

.background-preview {
	width: 100%;
	height: 100px;
	object-fit: cover;
	margin-bottom: 10px;
	border-radius: 4px;
}

.upload-preview {
	margin-top: 5px;
}

/* Character form inputs alignment */
.character-customization input[type="text"],
.character-customization textarea {
	width: calc(100% - 5px); /* Make slightly narrower to avoid scrolling */
	padding: 10px;
	background-color: #2a2a2a;
	border: 1px solid #444;
	border-radius: 4px;
	color: #fff;
	margin-top: 5px;
}

.character-customization textarea {
	resize: vertical;
	font-family: inherit;
	line-height: 1.5;
	min-height: 80px; /* Ensure minimum height */
}

/* Error Toast */
.error-toast {
	position: fixed;
	top: 20px;
	left: 50%;
	transform: translateX(-50%);
	background-color: rgba(255, 77, 79, 0.9);
	color: white;
	padding: 12px 20px;
	border-radius: 8px;
	z-index: 1000;
	display: flex;
	align-items: center;
	gap: 10px;
	box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
	max-width: 80%;
	animation: fadeIn 0.3s ease-out;
}

.error-toast button {
	background: transparent;
	border: none;
	color: white;
	font-size: 18px;
	cursor: pointer;
	padding: 0 5px;
}

@keyframes fadeIn {
	from {
		opacity: 0;
		transform: translate(-50%, -10px);
	}
	to {
		opacity: 1;
		transform: translate(-50%, 0);
	}
}

/* File System Indicator */
.filesystem-indicator {
	position: fixed;
	bottom: 10px;
	left: 50%;
	transform: translateX(-50%);
	background-color: rgba(0, 0, 0, 0.7);
	padding: 5px 10px;
	border-radius: 4px;
	font-size: 12px;
	color: #aaa;
	display: flex;
	align-items: center;
	gap: 10px;
	z-index: 10;
}

.filesystem-indicator.warning {
	background-color: rgba(255, 166, 0, 0.4);
	color: #fff;
}

.filesystem-indicator button {
	background-color: #333;
	border: none;
	color: #fff;
	padding: 3px 6px;
	border-radius: 3px;
	font-size: 11px;
	cursor: pointer;
}

/* Image Cropper Modal */
.image-cropper-modal {
	position: fixed;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	background: rgba(0, 0, 0, 0.75);
	display: flex;
	align-items: center;
	justify-content: center;
	z-index: 1000;
	backdrop-filter: blur(4px);
}

.image-cropper-content {
	background: #1e1e1e;
	padding: 20px;
	border-radius: 10px;
	max-width: 90%;
	max-height: 90%;
	overflow: auto;
	box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
}

.crop-container {
	margin: 20px 0;
}

.cropper-actions {
	display: flex;
	justify-content: space-between;
	margin-top: 15px;
}

.cancel-button {
	background-color: #666;
	color: white;
	border: none;
	padding: 8px 16px;
	border-radius: 4px;
	cursor: pointer;
}

.confirm-button {
	background-color: #4caf50;
	color: white;
	border: none;
	padding: 8px 16px;
	border-radius: 4px;
	cursor: pointer;
}

/* Delete Confirmation Modal */
.modal-overlay {
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background-color: rgba(0, 0, 0, 0.7);
	display: flex;
	justify-content: center;
	align-items: center;
	z-index: 1000;
	backdrop-filter: blur(3px);
}

.modal-content {
	background-color: rgba(42, 42, 42, 0.95);
	padding: 20px;
	border-radius: 8px;
	max-width: 400px;
	width: 100%;
	box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
}

.delete-confirmation-modal h3 {
	margin-top: 0;
	color: #ff4d4f;
}

.warning-text {
	color: #ff7875;
	font-style: italic;
}

.modal-actions {
	display: flex;
	justify-content: flex-end;
	gap: 10px;
	margin-top: 20px;
}

.delete-confirm-button {
	background-color: #ff4d4f;
}

.delete-confirm-button:hover {
	background-color: #ff7875;
}

/* Input field that can be edited via popup */
.editable-field {
	cursor: pointer;
	position: relative;
}

.editable-field::after {
	content: none; /* Remove the pencil icon */
}

/* Ensure editable field hover state is visible without the icon */
.editable-field:hover input,
.editable-field:hover textarea {
	border-color: #646cff;
}

/* Sender name in messages */
.message-sender {
	position: absolute;
	top: 8px;
	font-size: 12px;
	font-weight: bold;
	opacity: 0.8;
	z-index: 2;
}

.user-message .message-sender {
	right: 8px; /* Position on the right for user messages */
	left: auto; /* Reset left positioning */
	color: #a0c0ff;
}

.character-message .message-sender {
	left: 8px;
	color: #a0ffc0;
}

/* Edit Field Modal */
.edit-field-modal {
	background-color: #2a2a2a;
	padding: 25px;
	border-radius: 8px;
	max-width: 600px;
	width: 90%;
	max-height: 80vh;
	display: flex;
	flex-direction: column;
	/* Add these properties to ensure proper positioning */
	position: relative; /* Ensure it respects parent positioning */
	margin: 0 auto; /* Center horizontally */
	overflow: auto; /* Allow scrolling if content is too large */
	box-sizing: border-box; /* Include padding in width calculation */
}

/* Add responsive adjustments for mobile */
@media (max-width: 768px) {
	.modal-content {
		width: 95%;
		padding: 15px;
	}

	/* Show the side panels in mobile mode */
	.side-panel {
		display: block !important;
	}

	/* Side panels in mobile mode take full width when expanded */
	.side-panel.mobile.expanded {
		width: 100vw !important;
		z-index: 10;
	}

	/* Collapse buttons always visible in mobile mode */
	.collapse-button.vertical {
		display: block !important;
	}

	/* When side panel is expanded in mobile, hide the chat pane */
	.chat-pane.hidden {
		visibility: hidden;
	}

	/* Adjust padding for mobile view */
	.side-panel .pane-content {
		padding: 15px;
	}

	/* Make sure the chat pane takes full width on mobile */
	.chat-pane {
		width: 100vw;
		padding: 15px;
	}

	/* Adjust character grid for better mobile display */
	.character-grid {
		grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
		gap: 10px;
	}

	/* Chat header in mobile view */
	.chat-header {
		flex-direction: column;
		align-items: flex-start;
	}

	.chat-header-actions {
		order: -1;
		margin-bottom: 10px;
		margin-right: 0;
		align-self: flex-end;
	}

	.chat-dropdown-container {
		width: 100%;
	}
}

/* Enhanced Edit Field Modal Styles */
.modal-backdrop {
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background-color: rgba(0, 0, 0, 0.5);
	backdrop-filter: blur(5px);
	display: flex;
	justify-content: center;
	align-items: center;
	z-index: 1000;
	padding: 20px; /* Add padding to ensure modal doesn't touch edges */
	box-sizing: border-box; /* Include padding in width calculation */
}

/* Add specific styling when modal-content is inside edit-field-modal */
.edit-field-modal .modal-content {
	width: 100%; /* Take full width of parent */
	max-width: none; /* Don't constrain width */
	margin: 0; /* Remove margin */
	padding: 0; /* Remove padding as parent already has it */
	background-color: transparent; /* Use parent background */
	box-shadow: none; /* Remove shadow as parent has it */
	border-radius: 0; /* Remove border radius */
}

.edit-field-modal {
	background-color: #2a2a2a;
	border-radius: 8px;
	box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
	width: 90%;
	max-width: 600px;
	max-height: 90vh;
	display: flex;
	flex-direction: column;
	overflow: hidden; /* Prevents content from spilling out */
}

.modal-header {
	padding: 15px 20px;
	border-bottom: 1px solid #3a3a3a;
	display: flex;
	justify-content: space-between;
	align-items: center;
}

.modal-header h3 {
	margin: 0;
	color: #fff;
}

.close-button {
	background: none;
	border: none;
	font-size: 24px;
	color: #aaa;
	cursor: pointer;
}

.close-button:hover {
	color: #fff;
}

.modal-description {
	padding: 10px 20px;
	color: #aaa;
	font-size: 0.9rem;
	border-bottom: 1px solid #3a3a3a;
}

.modal-content {
	padding: 20px;
	flex-grow: 1;
	overflow-y: auto; /* Allow scrolling within content area */
}

.edit-textarea,
.edit-input {
	width: 100%;
	background-color: #333;
	border: 1px solid #444;
	border-radius: 4px;
	color: #fff;
	font-size: 1rem;
	padding: 12px;
	box-sizing: border-box; /* Include padding in width calculation */
	resize: vertical;
}

.edit-textarea {
	min-height: 120px;
	line-height: 1.5;
	overflow-y: auto; /* Allow textarea to scroll internally */
	max-height: 400px; /* Prevent excessive height */
}

.edit-textarea:focus,
.edit-input:focus {
	outline: none;
	border-color: #666;
}

.modal-footer {
	padding: 15px 20px;
	border-top: 1px solid #3a3a3a;
	display: flex;
	justify-content: flex-end;
	gap: 10px;
}

/* Chat Dropdown Styles */
.chat-dropdown-container {
	position: relative;
	width: 100%;
	margin-bottom: 15px;
	z-index: 5;
}

.chat-dropdown-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: 10px 15px;
	background-color: rgba(42, 42, 42, 0.8);
	border-radius: 6px;
	cursor: pointer;
	transition: background-color 0.2s ease;
}

.chat-dropdown-header:hover {
	background-color: rgba(58, 58, 58, 0.8);
}

/* Style for when there are no chats */
.chat-dropdown-header.no-chats {
	background-color: rgba(100, 108, 255, 0.3);
	border: 1px dashed rgba(100, 108, 255, 0.5);
}

.chat-dropdown-header.no-chats:hover {
	background-color: rgba(100, 108, 255, 0.4);
}

.chat-dropdown-title {
	font-weight: 500;
	overflow: hidden;
	text-overflow: ellipsis;
	white-space: nowrap;
}

.chat-dropdown-icons {
	display: flex;
	align-items: center;
	gap: 8px;
}

.chat-dropdown-button {
	background-color: transparent;
	border: none;
	color: #ccc;
	padding: 4px;
	min-width: 28px;
	min-height: 28px;
	border-radius: 4px;
	display: flex;
	align-items: center;
	justify-content: center;
	cursor: pointer;
	transition: all 0.2s ease; /* Changed to 'all' for smoother transitions */
}

.chat-dropdown-button:hover:not(:disabled) {
	background-color: rgba(255, 255, 255, 0.15);
	color: #fff;
	transform: scale(1.1); /* Add slight scale effect on hover */
}

/* Specific button styles to control size independently */
.chat-dropdown-button.new-button {
	font-size: 22px;
	font-weight: bold;
	line-height: 20px;
	margin-bottom: 3px; /* Add margin to move it down further */
	position: relative;
	top: 0px; /* Push it down slightly */
}

.chat-dropdown-button.new-button:hover {
	color: #4caf50; /* Green hover color */
}

.chat-dropdown-button.edit-button {
	font-size: 16px;
}

.chat-dropdown-button.edit-button:hover {
	color: #2196f3; /* Blue hover color */
}

.chat-dropdown-button.export-button {
	font-size: 22px; /* Increased size to match other buttons */
	font-weight: bold;
	line-height: 23px; /* Higher line-height to move it down */
	margin-bottom: 3px; /* Add margin to move it down further */
	position: relative;
	top: 3px; /* Push it down slightly */
	transform: scale(1.4); /* Add slight scale effect on hover */
}

.chat-dropdown-button.export-button:hover {
	color: #ff9800; /* Orange hover color */
	transform: scale(1.5); /* Add slight scale effect on hover */
}

.chat-dropdown-button.delete-button {
	font-size: 22px;
	font-weight: bold;
	line-height: 20px;
}

.chat-dropdown-button.delete-button:hover {
	color: #f44336; /* Red hover color */
}

.chat-dropdown-arrow {
	color: #ccc;
	font-size: 12px;
	margin-left: 10px;
}

.chat-dropdown-list {
	position: absolute;
	top: 100%;
	left: 0;
	width: 100%;
	max-height: 200px;
	overflow-y: auto;
	background-color: rgba(42, 42, 42, 0.95);
	border-radius: 0 0 6px 6px;
	box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
	z-index: 10;
	margin-top: 4px;
}

.chat-dropdown-item {
	padding: 10px 15px;
	cursor: pointer;
	transition: background-color 0.2s ease;
	white-space: nowrap;
	overflow: hidden;
	text-overflow: ellipsis;
}

.chat-dropdown-item:hover {
	background-color: rgba(58, 58, 58, 0.7);
}

.chat-dropdown-item.active {
	background-color: rgba(100, 108, 255, 0.2);
	border-left: 3px solid #646cff;
}

.chat-dropdown-placeholder {
	padding: 10px 15px;
	color: #666;
	font-style: italic;
	text-align: center;
}

/* System Message Styles */
.system-message {
	align-self: center;
	max-width: 90%;
	text-align: center;
	margin: 10px 0;
}

.system-message .message-content {
	background-color: rgba(85, 85, 85, 0.7);
	border-radius: 8px;
	padding: 15px 20px;
	padding-top: 30px; /* Proper padding for system messages */
	font-style: italic;
	color: #e0e0e0;
	box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
	border: 1px solid rgba(255, 255, 255, 0.05);
	max-width: 600px;
	display: block; /* Use block display for system messages */
}

.system-message .message-sender {
	color: #aaa;
	font-size: 11px;
	position: absolute;
	top: 8px;
	left: 50%; /* Center the label */
	transform: translateX(-50%); /* Center the label */
	text-transform: uppercase;
	letter-spacing: 1px;
	text-align: center;
	width: auto; /* Let width be based on content */
	max-width: 90%; /* But don't let it get too wide */
}

/* Error Message Styles */
.error-message .message-content {
	background-color: rgba(255, 77, 77, 0.7) !important;
	border: 1px solid rgba(255, 0, 0, 0.2);
}

.error-message .message-sender {
	color: #ff5555 !important;
	font-weight: bold;
}

.error-delete {
	position: absolute;
	top: 5px;
	right: 10px;
	background: transparent;
	color: rgba(255, 255, 255, 0.8);
	border: none;
	font-size: 18px;
	cursor: pointer;
}

.error-delete:hover {
	color: #fff;
}

/* Modal styles for better visibility on backgrounds */
.modal-content {
	background-color: rgba(42, 42, 42, 0.95);
	box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
	border-radius: 10px;
	padding: 25px;
}

.modal-overlay {
	backdrop-filter: blur(8px);
	background-color: rgba(0, 0, 0, 0.8);
}

/* New chat and edit chat modals */
.edit-chat-modal,
.new-chat-modal {
	max-width: 550px;
	width: 100%;
	padding: 30px; /* Increase overall padding */
}

.edit-chat-modal h3,
.new-chat-modal h3 {
	margin-top: 0;
	margin-bottom: 20px;
	font-size: 24px;
	color: #fff;
	border-bottom: 1px solid rgba(255, 255, 255, 0.1);
	padding-bottom: 15px;
}

.edit-chat-modal .form-group,
.new-chat-modal .form-group {
	margin-bottom: 25px;
}

.edit-chat-modal label,
.new-chat-modal label {
	display: block;
	margin-bottom: 10px;
	font-weight: 500;
	font-size: 16px;
}

.edit-chat-modal input[type="text"],
.new-chat-modal input[type="text"],
.edit-chat-modal textarea,
.new-chat-modal textarea {
	width: 100%;
	padding: 12px 15px;
	background-color: rgba(30, 30, 30, 0.8);
	border: 1px solid rgba(255, 255, 255, 0.1);
	border-radius: 6px;
	color: #fff;
	font-size: 16px;
	transition: border-color 0.2s ease;
	box-sizing: border-box; /* Ensure padding is included in width */
	margin-bottom: 5px;
}

.edit-chat-modal input[type="text"]:focus,
.new-chat-modal input[type="text"]:focus,
.edit-chat-modal textarea:focus,
.new-chat-modal textarea:focus {
	border-color: #646cff;
	outline: none;
}

.edit-chat-modal textarea,
.new-chat-modal textarea {
	min-height: 100px;
	resize: vertical;
}

.edit-chat-modal input[type="file"],
.new-chat-modal input[type="file"] {
	margin-top: 10px;
	background-color: transparent;
	width: 100%;
}

.default-note {
	margin-left: 8px;
	font-size: 13px;
	color: #aaa;
	font-style: italic;
}

.input-hint {
	font-size: 13px;
	color: #ff9800;
	margin-top: 8px;
}

.default-filled-hint {
	font-size: 13px;
	color: #4caf50;
	margin-top: 8px;
	font-style: italic;
}

.validation-error {
	color: #f44336;
	margin: 15px 0;
	padding: 10px;
	background-color: rgba(244, 67, 54, 0.1);
	border-radius: 6px;
	font-size: 14px;
}

.modal-actions {
	display: flex;
	justify-content: flex-end;
	gap: 15px;
	margin-top: 30px;
}

.cancel-button {
	background-color: #666;
	color: white;
	border: none;
	padding: 10px 25px;
	border-radius: 6px;
	cursor: pointer;
	font-size: 15px;
	transition: background-color 0.2s ease;
}

.cancel-button:hover {
	background-color: #777;
}

.save-button {
	background-color: #4caf50;
	color: white;
	border: none;
	padding: 10px 25px;
	border-radius: 6px;
	cursor: pointer;
	font-size: 15px;
	transition: background-color 0.2s ease;
}

.save-button:hover {
	background-color: #5cba60;
}

.background-preview {
	width: 100%;
	height: 120px;
	object-fit: cover;
	border-radius: 8px;
	margin: 10px 0;
	border: 1px solid rgba(255, 255, 255, 0.1);
}

/* Modal styles for better visibility on backgrounds */
.modal-content {
	background-color: rgba(42, 42, 42, 0.95);
	box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
}

.modal-overlay {
	backdrop-filter: blur(8px);
	background-color: rgba(0, 0, 0, 0.8);
}

/* New chat and edit chat modals */
.edit-chat-modal,
.new-chat-modal {
	max-width: 500px;
	width: 100%;
}

.default-note {
	margin-left: 8px;
	font-size: 12px;
	color: #888;
	font-style: italic;
}

.input-hint {
	font-size: 12px;
	color: #ff9800;
	margin-top: 4px;
}

.validation-error {
	color: #f44336;
	margin: 10px 0;
	padding: 8px;
	background-color: rgba(244, 67, 54, 0.1);
	border-radius: 4px;
	font-size: 14px;
}

.background-preview {
	width: 100%;
	height: 120px;
	object-fit: cover;
	border-radius: 4px;
	margin: 10px 0;
}

.default-preview {
	opacity: 0.7;
}

/* Temperature slider styling */
.temperature-selection-container {
	margin-bottom: 20px;
}

.temperature-selection-container label {
	display: block;
	margin-bottom: 8px;
	font-weight: 500;
}

.temperature-value {
	font-weight: normal;
	color: #646cff;
}

.temperature-slider-container {
	position: relative;
	width: 100%;
	margin-top: 10px;
	margin-bottom: 10px;
}

.temperature-slider {
	width: 100%;
	height: 6px;
	-webkit-appearance: none;
	appearance: none;
	background: linear-gradient(to right, #3a3a3a 0%, #646cff 50%, #ff7875 100%);
	outline: none;
	border-radius: 3px;
	cursor: pointer;
}

.temperature-slider::-webkit-slider-thumb {
	-webkit-appearance: none;
	appearance: none;
	width: 18px;
	height: 18px;
	border-radius: 50%;
	background: #fff;
	cursor: pointer;
	border: 2px solid #646cff;
	box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
}

.temperature-slider::-moz-range-thumb {
	width: 18px;
	height: 18px;
	border-radius: 50%;
	background: #fff;
	cursor: pointer;
	border: 2px solid #646cff;
	box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
}

.temperature-labels {
	display: flex;
	justify-content: space-between;
	margin-top: 8px;
	font-size: 0.8rem;
	color: #aaa;
	position: relative; /* Add position relative to allow absolute positioning of middle label */
}

.temp-label-min {
	text-align: left;
}

.temp-label-mid {
	position: absolute; /* Position absolutely */
	left: 50%; /* Center horizontally */
	transform: translateX(-50%); /* Adjust for element width */
	text-align: center;
}

.temp-label-max {
	text-align: right;
}

/* Edit indicator styling */
.edit-indicator {
	font-size: 0.7rem;
	color: #888;
	font-style: italic;
	margin-top: 3px;
	text-align: right;
}

/* Edit Message Modal */
.edit-message-modal {
	max-width: 500px;
	width: 100%;
}

.edit-message-modal textarea {
	width: 100%;
	min-height: 100px;
	padding: 12px 15px;
	background-color: rgba(30, 30, 30, 0.8);
	border: 1px solid rgba(255, 255, 255, 0.1);
	border-radius: 6px;
	color: #fff;
	font-size: 16px;
	resize: vertical;
	box-sizing: border-box;
}

.edit-message-modal textarea:focus {
	border-color: #646cff;
	outline: none;
}

/* Message action button states */
.message-action:disabled {
	opacity: 0.4;
	cursor: not-allowed;
}

.message-action:disabled:hover {
	background-color: transparent;
}

/* Chat dropdown takes the full width on mobile */
@media (max-width: 768px) {
	.chat-header {
		flex-direction: column;
	}

	.chat-dropdown-container {
		width: 100%;
	}
}

/* Markdown styling */
.markdown-content {
	width: 100%;
}

.markdown-content p {
	margin: 0 0 0.5em 0;
}

.markdown-content ul,
.markdown-content ol {
	margin: 0.5em 0;
	padding-left: 1.5em;
}

.markdown-content h1,
.markdown-content h2,
.markdown-content h3 {
	margin: 0.5em 0;
}

.markdown-content a {
	color: #8f96ff;
	text-decoration: none;
}

/* Add hover effects */
.markdown-content a:hover {
	color: #8f96ff; /* Lighter shade when hovering */
	text-decoration: underline;
	background-color: rgba(100, 108, 255, 0.1); /* Subtle background on hover */
	border-radius: 2px;
}

/* Change italics style for actions - more subtle faded white instead of blue */
.markdown-content em {
	color: rgba(255, 255, 255, 0.4); /* Slightly faded white */
	font-style: italic;
}

.markdown-content strong {
	font-weight: bold;
}

/* Special style for text with both bold and italics */
.markdown-content strong em,
.markdown-content em strong {
	color: #ffffff; /* Orange-gold color */
	font-weight: bold;
	font-style: italic;
	text-shadow: 0 0 2px rgba(255, 157, 0, 0.3);
}

/* Help modal */
.help-modal {
	max-width: 600px;
	width: 90%;
}

.help-content {
	max-height: 60vh;
	overflow-y: auto;
	padding: 10px 20px;
	line-height: 1.6;
	text-align: justify;
}

.help-content h2 {
	margin-top: 0;
	color: #fff;
	border-bottom: 1px solid rgba(255, 255, 255, 0.1);
	padding-bottom: 10px;
}

/* Help Modal Logo Styling */
.logo-container {
	display: flex;
	justify-content: center;
	margin-bottom: 15px;
	margin-top: 15px;
}

.help-modal-logo {
	height: 64px;
	width: 64px;
	object-fit: contain;
}

/* Center the main heading in help modal */
.help-content h2:first-of-type {
	text-align: center;
}

.centered-heading {
	text-align: center;
}

/* API Key modal */
.api-key-modal {
	max-width: 500px;
	width: 90%;
}

.api-key-input-container {
	margin-bottom: 20px;
}

.api-key-input-container label,
.model-selection-container label {
	display: block;
	margin-bottom: 8px;
	font-weight: 500;
}

.secure-input-wrapper {
	position: relative;
	width: 100%;
	margin-bottom: 10px;
}

.secure-input {
	width: 100%;
	padding: 12px 40px 12px 12px; /* Extra padding on right for the toggle button */
	background-color: rgba(30, 30, 30, 0.8);
	border: 1px solid rgba(255, 255, 255, 0.1);
	border-radius: 6px;
	color: #fff;
	font-family: monospace;
	box-sizing: border-box;
}

.secure-input:focus {
	border-color: #646cff;
	outline: none;
}

.toggle-visibility-button {
	position: absolute;
	right: 10px;
	top: 50%;
	transform: translateY(-50%);
	background: transparent;
	border: none;
	color: #999;
	cursor: pointer;
	padding: 5px;
}

/* Model selection styling */
.model-selection-container {
	margin-bottom: 20px;
}

.model-select {
	width: 100%;
	padding: 12px;
	background-color: rgba(30, 30, 30, 0.8);
	border: 1px solid rgba(255, 255, 255, 0.1);
	border-radius: 6px;
	color: #fff;
	font-family: inherit;
	cursor: pointer;
	appearance: none; /* Remove default arrow */
	-webkit-appearance: none;
	-moz-appearance: none;
	background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
	background-repeat: no-repeat;
	background-position: right 12px center;
	background-size: 18px;
}

.model-select:focus {
	border-color: #646cff;
	outline: none;
}

.model-description {
	margin-top: 8px;
	font-size: 0.9rem;
	color: #aaa;
	font-style: italic;
}

/* Emotion Classifier Section */
.emotion-classifier-container {
	margin-bottom: 20px;
}

.emotion-classifier-container label {
	display: block;
	margin-bottom: 8px;
	font-weight: 500;
}

.emotion-classifier-status {
	display: flex;
	align-items: center;
	gap: 15px;
	margin-bottom: 10px;
	flex-wrap: wrap;
}

.status-indicator {
	font-weight: 500;
	font-size: 0.9rem;
}

.download-model-button,
.retry-button {
	background-color: #646cff;
	color: white;
	border: none;
	padding: 8px 15px;
	border-radius: 6px;
	cursor: pointer;
	font-size: 14px;
	transition: background-color 0.2s ease;
}

.download-model-button:hover,
.retry-button:hover {
	background-color: #5258d8;
}

.download-progress {
	color: #007bff;
	font-style: italic;
	font-size: 0.9rem;
}

.success-message {
	color: #28a745;
	font-weight: 500;
	font-size: 0.9rem;
}

.error-message {
	color: #dc3545;
	font-size: 0.9rem;
	display: flex;
	flex-direction: column;
	gap: 10px;
}

.retry-button {
	background-color: #dc3545;
	padding: 4px 8px;
	font-size: 12px;
}

.retry-button:hover {
	background-color: #c82333;
}

.info-box {
	margin-top: 15px;
	padding: 15px;
	background-color: rgba(255, 255, 255, 0.05);
	border-radius: 6px;
	border: 1px solid rgba(255, 255, 255, 0.1);
}

/* Persona modal */
.persona-modal {
	max-width: 500px;
	width: 90%;
}

.persona-modal .form-group {
	margin-bottom: 20px;
}

.persona-modal label {
	display: block;
	margin-bottom: 8px;
	font-weight: 500;
}

.persona-modal input[type="text"],
.persona-modal textarea {
	width: 100%;
	padding: 12px 15px;
	background-color: rgba(30, 30, 30, 0.8);
	border: 1px solid rgba(255, 255, 255, 0.1);
	border-radius: 6px;
	color: #fff;
	font-size: 15px;
	transition: border-color 0.2s ease;
	box-sizing: border-box;
	resize: vertical;
}

.persona-modal input[type="text"]:focus,
.persona-modal textarea:focus {
	border-color: #646cff;
	outline: none;
}

/* Modal shared styles */
.modal-body {
	padding: 0 20px;
	flex-grow: 1;
	overflow-y: auto;
	max-height: 60vh;
}

.modal-description {
	margin-bottom: 20px;
	color: #aaa;
	line-height: 1.5;
	padding-bottom: 10px;
	border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

/* Chat dropdown takes the full width on mobile */
@media (max-width: 768px) {
	.chat-header {
		flex-direction: column;
		align-items: flex-start;
	}

	.chat-header-actions {
		order: -1;
		margin-bottom: 10px;
		margin-right: 0;
		align-self: flex-end;
	}

	.chat-dropdown-container {
		width: 100%;
	}
}

/* No Chats Placeholder */
.no-chats-placeholder {
	flex: 1;
	display: flex;
	justify-content: center;
	align-items: center;
	background-color: rgba(0, 0, 0, 0.4);
	border-radius: 6px;
	margin: 15px 0;
	padding: 15px;
}

.no-chats-message {
	text-align: center;
	padding: 20px;
	background-color: rgba(55, 55, 55, 0.7);
	border-radius: 8px;
	border: 1px solid rgba(100, 108, 255, 0.3);
	max-width: 80%;
}

.no-chats-message p {
	font-size: 1.2rem;
	margin-bottom: 15px;
	color: #ccc;
}

.create-chat-button {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding: 10px 20px;
	background-color: rgba(100, 108, 255, 0.7);
	border: none;
	border-radius: 6px;
	color: #fff;
	font-size: 16px;
	cursor: pointer;
	transition: background-color 0.2s ease;
}

.create-chat-button:hover {
	background-color: rgba(100, 108, 255, 0.9);
}

.plus-icon {
	margin-left: 8px;
	font-weight: bold;
	font-size: 18px;
}

/* Persona Modal Danger Zone */
.danger-zone {
	margin-top: 20px;
	padding: 15px;
	background-color: rgba(255, 0, 0, 0.1);
	border-radius: 6px;
	border: 1px solid rgba(255, 0, 0, 0.2);
}

.danger-zone h4 {
	color: #ff4d4f;
	margin-top: 0;
	margin-bottom: 10px;
}

.reset-app-data-button {
	background-color: #ff4d4f;
	color: white;
	border: none;
	padding: 8px 15px;
	border-radius: 4px;
	cursor: pointer;
	transition: background-color 0.2s ease;
}

.reset-app-data-button:hover {
	background-color: #ff7875;
}

.danger-note {
	color: #ff7875;
	font-size: 12px;
	margin-top: 8px;
	font-style: italic;
}

/* Data Management Zone */
.data-management-zone {
	margin-top: 20px;
	padding: 15px;
	background-color: rgba(0, 119, 255, 0.1);
	border-radius: 6px;
	border: 1px solid rgba(0, 119, 255, 0.2);
}

.data-management-zone h4 {
	color: #0077ff;
	margin-top: 0;
	margin-bottom: 10px;
}

.data-buttons {
	display: flex;
	gap: 10px;
}

.export-data-button,
.import-data-button {
	background-color: #0077ff;
	color: white;
	border: none;
	padding: 8px 15px;
	border-radius: 4px;
	cursor: pointer;
	transition: background-color 0.2s ease;
	flex: 1;
}

.export-data-button:hover,
.import-data-button:hover {
	background-color: #0066dd;
}

.data-management-note {
	color: #0077ff;
	font-size: 12px;
	margin-top: 8px;
	font-style: italic;
}

/* Background Preview Container */
.background-preview-container {
	position: relative;
	margin-bottom: 10px;
}

.remove-background-button {
	position: absolute;
	bottom: 10px;
	right: 10px;
	background-color: rgba(255, 77, 79, 0.8);
	color: white;
	border: none;
	border-radius: 4px;
	padding: 5px 10px;
	cursor: pointer;
	font-size: 12px;
	transition: background-color 0.2s ease;
}

.remove-background-button:hover {
	background-color: rgba(255, 77, 79, 1);
}

/* Help Modal Startup Preference */
.startup-preference {
	flex: 1;
	display: flex;
	align-items: center;
}

.hide-at-startup-label {
	display: flex;
	align-items: center;
	gap: 8px;
	color: #aaa;
	font-size: 14px;
	cursor: pointer;
}

.hide-at-startup-label input[type="checkbox"] {
	width: 16px;
	height: 16px;
	cursor: pointer;
	accent-color: #646cff;
}

/* Adjust the modal footer for the new layout */
.help-modal .modal-footer {
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: 15px 20px;
}

/* Save As Options Modal */
.save-as-modal {
	max-width: 500px;
	width: 90%;
}

.save-options {
	display: flex;
	gap: 20px;
	margin: 20px 0;
}

/* Vertical layout for save options */
.save-options-vertical {
	flex-direction: column;
}

.save-option {
	flex: 1;
	padding: 20px;
	background-color: rgba(42, 42, 42, 0.5);
	border: 1px solid rgba(255, 255, 255, 0.1);
	border-radius: 8px;
	cursor: pointer;
	transition: all 0.2s ease;
	margin-bottom: 15px;
}

.save-option-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	margin-bottom: 10px;
}

.save-option-tag {
	background-color: rgba(100, 108, 255, 0.3);
	color: #fff;
	font-size: 0.75rem;
	padding: 2px 8px;
	border-radius: 12px;
	font-weight: 500;
}

.save-option:last-child .save-option-tag {
	background-color: rgba(76, 175, 80, 0.3);
}

.save-option:hover {
	background-color: rgba(100, 108, 255, 0.2);
	border-color: rgba(100, 108, 255, 0.4);
	transform: translateY(-2px);
}

.save-option h4 {
	margin: 0;
	color: #fff;
}

.save-option p {
	margin: 5px 0;
	color: #ddd;
}

.save-option-note {
	font-size: 0.9em;
	color: #aaa !important;
	font-style: italic;
}

@media (max-width: 600px) {
	.save-options {
		flex-direction: column;
	}
}

/* Chat Dropdown Button Styles */
.chat-dropdown-button.export-button {
	font-size: 14px;
	font-weight: bold;
	padding-top: 2px; /* Adjust slightly for the arrow */
}

/* Side Panels - Updated for improved mobile handling */
.side-panel {
	position: fixed;
	top: 0;
	height: 100vh;
	background-color: rgba(30, 30, 30, 0.95); /* Increase opacity for better readability */
	backdrop-filter: blur(8px);
	border: none;
	overflow: hidden;
	z-index: 2;
	transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
	will-change: transform;
}

/* Adjust the mobile side panel positions */
.side-panel.mobile.left-panel.expanded {
	transform: translateX(0);
	left: 0;
}

.side-panel.mobile.right-panel.expanded {
	transform: translateX(0);
	right: 0;
}

/* Mobile-specific fixes */
@media screen and (max-width: 768px) {
	/* Fix chat pane positioning to prevent overlap with side panel buttons */
	.chat-pane {
		width: calc(100vw - 80px); /* Subtract the width of both collapse buttons */
		left: 40px; /* Position it after the left collapse button */
		transform: none; /* Remove the -50% transform */
		padding: 15px; /* Keep the reduced padding */
	}

	/* Improve scrolling for side panels in mobile mode */
	.side-panel.mobile .pane-content {
		max-height: 100vh;
		overflow-y: auto;
		padding-bottom: 80px; /* Add extra padding at bottom to ensure scrollability */
		-webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
	}

	/* Fix for character form in mobile mode */
	.side-panel.mobile .character-customization {
		padding-bottom: 100px; /* Extra padding at bottom */
	}

	/* Additional fixes for side panels in mobile mode */
	.side-panel.mobile.expanded {
		width: 100vw !important;
		z-index: 10;
	}

	/* Left panel specific positioning in mobile mode */
	.side-panel.mobile.left-panel {
		left: 0;
	}

	/* Right panel specific positioning in mobile mode */
	.side-panel.mobile.right-panel {
		right: 0;
	}

	/* When a side panel is expanded in mobile, hide the chat pane properly */
	.chat-pane.hidden {
		visibility: hidden;
	}
}

/* Fix for layout resetting after modal close on mobile */
@media screen and (max-width: 768px) {
	.modal-backdrop {
		position: fixed; /* Ensure modal stays fixed */
		z-index: 1001; /* Keep modal above everything */
	}

	/* Force chat-pane to maintain correct position even after modal interactions */
	.chat-pane {
		width: calc(100vw - 80px) !important; /* Use !important to override any inline styles */
		left: 40px !important;
		transform: none !important;
		position: fixed !important;
	}
}

/* Improve modal scrolling on mobile */
@media screen and (max-width: 768px) {
	.modal-content {
		max-height: 85vh; /* Limit height to avoid overflow issues */
		overflow-y: auto; /* Enable vertical scrolling */
		-webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
		padding-bottom: 30px; /* Add extra padding at bottom */
	}

	/* Specific fixes for different modal types */
	.api-key-modal .modal-body,
	.persona-modal .modal-body,
	.help-modal .modal-body,
	.edit-message-modal .form-group,
	.edit-field-modal .modal-content {
		max-height: 60vh;
		overflow-y: auto;
		-webkit-overflow-scrolling: touch;
	}

	/* Ensure modal footer stays visible */
	.modal-footer {
		position: sticky;
		bottom: 0;
		background-color: rgba(42, 42, 42, 0.95);
		padding: 15px 20px;
		z-index: 1;
	}
}

/* Mobile-specific fixes for chat UI */
@media screen and (max-width: 768px) {
	/* Fix for send message button positioning */
	.chat-pane {
		display: flex;
		flex-direction: column;
		height: calc(100vh - 30px);
	}

	.chat-messages {
		flex: 1;
		max-height: calc(100vh - 180px);
		overflow-y: auto;
		margin-bottom: 8px;
	}

	.chat-input {
		position: relative;
		bottom: 0;
		width: 100%;
		background-color: rgba(18, 18, 18, 0.6);
		padding: 10px 0;
		margin-top: 10px;
		gap: 5px;
		align-items: center; /* Center items vertically */
	}

	.chat-input textarea {
		min-height: 24px; /* Match button height */
		max-height: 24px; /* Limit max expansion */
		padding: 8px 10px; /* Reduce padding */
		font-size: 14px; /* Smaller font size */
		line-height: 1.3; /* Tighter line height */
		margin-top: -5px; /* Raise it up a bit */
	}

	.chat-input button {
		padding: 8px 16px; /* Smaller padding */
		font-size: 14px; /* Smaller font */
		height: 40px; /* Fixed height */
		margin-top: -5px; /* Raise it up a bit */
	}

	/* Adjust chat bubble width */
	.message {
		max-width: 90%;
	}

	.message-content {
		min-width: 150px;
		width: 100%;
		box-sizing: border-box;
	}

	.message-text {
		word-break: break-word;
		overflow-wrap: break-word;
		max-width: 100%;
	}

	/* Reduce avatar size */
	.character-avatar-container {
		width: 50px;
		height: 50px;
	}

	.character-message {
		gap: 8px;
	}

	/* Fix for button and name overlap in chat bubbles */
	.message-actions {
		top: 3px;
		opacity: 0.9;
	}

	.user-message .message-actions {
		left: 5px;
		max-width: 80px;
		display: flex;
		flex-wrap: wrap;
		gap: 2px;
	}

	.character-message .message-actions {
		right: 3px;
		max-width: 80px;
		display: flex;
		flex-wrap: wrap;
		gap: 2px;
	}

	.message-action {
		padding: 2px;
		min-width: 20px;
		height: 20px;
		font-size: 12px;
	}

	.message-sender {
		max-width: 40%;
		font-size: 10px;
		top: 6px;
	}

	.user-message .message-sender {
		right: 6px;
	}

	.character-message .message-sender {
		left: 6px;
	}

	.message-content {
		padding-top: 28px;
	}
}

/* Fix for empty space at bottom of chat pane on mobile */
@media screen and (max-width: 768px) {
	/* Adjust chat input container spacing */
	.chat-input {
		position: relative;
		bottom: 0;
		padding: 5px 0; /* Reduce padding from 10px to 5px */
		margin-top: 5px; /* Reduce margin from 10px to 5px */
	}

	/* Ensure proper textarea vertical alignment */
	.chat-input textarea {
		margin-top: 0; /* Remove negative margin */
		margin-bottom: 0;
		align-self: center; /* Center vertically */
	}

	/* Ensure proper button vertical alignment */
	.chat-input button {
		margin-top: 0; /* Remove negative margin */
		align-self: center; /* Center vertically */
		height: 36px; /* Slightly reduce height */
	}

	/* Fix chat messages container to leave proper space for input */
	.chat-messages {
		max-height: calc(100vh - 160px); /* Adjust for smaller input area */
		margin-bottom: 5px; /* Reduce margin */
	}

	/* Ensure the chat pane takes proper height */
	.chat-pane {
		height: 100vh; /* Full height */
		padding-bottom: 10px; /* Ensure some padding at bottom */
	}
}

/* Add this to fix elements being covered by mobile navigation bars */
@media screen and (max-width: 768px) {
	/* Fix chat pane to account for mobile nav bars */
	.chat-pane {
		height: calc(100vh - env(safe-area-inset-bottom, 50px));
		padding-bottom: env(safe-area-inset-bottom, 50px);
	}

	/* Ensure chat input is visible above navigation bars */
	.chat-input {
		position: sticky;
		bottom: env(safe-area-inset-bottom, 40px);
		margin-bottom: env(safe-area-inset-bottom, 40px);
		padding-bottom: 10px;
		background-color: rgba(18, 18, 18, 0.9); /* Make background more solid */
		z-index: 5; /* Ensure it stays on top */
	}

	/* Adjust messages container height */
	.chat-messages {
		max-height: calc(100vh - 180px - env(safe-area-inset-bottom, 40px));
		margin-bottom: 10px;
	}

	/* Ensure the button is clickable */
	.chat-input button {
		z-index: 6;
	}
}
/* Updated Emotion Classifier Section */
.emotion-classifier-container {
	border: 1px solid var(--border-color);
	border-radius: 8px;
	padding: 1rem;
	margin: 1rem 0;
}

.emotion-classifier-status {
	display: flex;
	flex-direction: column;
	gap: 0.5rem;
	margin: 0.5rem 0;
}

.status-indicator {
	font-weight: bold;
	font-size: 0.9rem;
}

.load-model-button {
	background: var(--primary-color);
	color: white;
	border: none;
	padding: 0.5rem 1rem;
	border-radius: 4px;
	cursor: pointer;
	font-size: 0.9rem;
	transition: background-color 0.2s;
	align-self: flex-start;
}

.load-model-button:hover {
	background: var(--primary-color-hover);
}

.loading-progress {
	color: var(--primary-color);
	font-style: italic;
}

.success-message {
	color: #28a745;
	font-weight: bold;
}

.error-message {
	color: #dc3545;
	display: flex;
	flex-direction: column;
	gap: 0.5rem;
}

.retry-button {
	background-color: #dc3545;
	color: white;
	border: none;
	padding: 0.25rem 0.5rem;
	border-radius: 4px;
	cursor: pointer;
	font-size: 0.8rem;
	align-self: flex-start;
}

.retry-button:hover {
	background-color: #c82333;
}

/* File Instructions Styling */
.file-instructions {
	background: #f8f9fa;
	border: 1px solid #dee2e6;
	border-radius: 6px;
	padding: 1rem;
	margin: 0.5rem 0;
	font-size: 0.9rem;
}

.file-instructions ol {
	margin: 0.5rem 0;
	padding-left: 1.5rem;
}

.file-instructions ul {
	margin: 0.5rem 0;
	padding-left: 1.5rem;
}

.file-instructions li {
	margin: 0.25rem 0;
}

.file-instructions code {
	background: #e9ecef;
	padding: 0.2rem 0.4rem;
	border-radius: 3px;
	font-family: "Courier New", monospace;
	font-size: 0.85rem;
}

.missing-file {
	color: #dc3545;
	font-weight: bold;
}

.found-file {
	color: #28a745;
	font-weight: bold;
}

.file-instructions a {
	color: var(--primary-color);
	text-decoration: none;
}

.file-instructions a:hover {
	text-decoration: underline;
}

/* Dark theme fixes for file instructions */
.file-instructions {
	background: #2a2a2a !important;
	border: 1px solid #444 !important;
	color: #e0e0e0 !important;
}

.file-instructions code {
	background: #333 !important;
	color: #f0f0f0 !important;
}

.file-instructions a {
	color: #64b5f6 !important;
}

.file-instructions a:hover {
	color: #90caf9 !important;
}

/* API Key Validation Status */
.validation-status {
	padding: 0.5rem;
	border-radius: 4px;
	margin: 0.5rem 0;
	font-size: 0.9rem;
	font-weight: 500;
}

.validation-status.testing {
	background: #e3f2fd;
	color: #1976d2;
	border: 1px solid #90caf9;
}

.validation-status.valid {
	background: #e8f5e8;
	color: #2e7d32;
	border: 1px solid #81c784;
}

.validation-status.invalid {
	background: #ffebee;
	color: #c62828;
	border: 1px solid #ef5350;
}

/* API Instructions Styling */
.api-instructions {
	margin-top: 1rem;
}

.api-instructions h4 {
	color: #fff;
	margin: 1rem 0 0.5rem 0;
	font-size: 1rem;
}

.api-instructions ol {
	margin: 0.5rem 0;
	padding-left: 1.5rem;
}

.api-instructions li {
	margin: 0.25rem 0;
	line-height: 1.4;
}

.api-instructions a {
	color: var(--primary-color);
	text-decoration: none;
}

.api-instructions a:hover {
	text-decoration: underline;
}

.api-instructions p {
	margin: 0.5rem 0;
	font-style: italic;
	color: #ccc;
}

/* Visual Novel Mode Toggle Button */
.vn-mode-button {
	background-color: #2c3e50;
	color: white;
}

.vn-mode-button.active {
	background-color: #e74c3c;
	color: white;
}

/* Visual Novel Mode Container */
.visual-novel-container {
	display: flex;
	flex-direction: column;
	height: 100%;
	width: 100%;
	overflow: hidden;
	position: relative;
	background-color: transparent;
}

/* Transparent chat messages in VN mode */
.chat-messages-transparent {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	opacity: 0;
	pointer-events: none;
	z-index: -1;
	background-color: transparent; /* Ensure transparency */
}

/* Visual Novel Mode */
.visual-novel-mode {
	position: fixed; /* Changed from absolute to fixed */
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	display: flex;
	flex-direction: column;
	justify-content: flex-end;
	align-items: center;
	z-index: 0; /* Lower z-index so it's behind chat-input and chat-header */
	background-color: transparent;
	padding-bottom: 100px; /* Increased space for chat input */
	pointer-events: none; /* Allow clicks to pass through the container */
}

/* Visual Novel Character Container */
.visual-novel-character-container {
	position: fixed; /* Changed from absolute to fixed */
	top: 130px; /* Start below the header instead of at the top */
	left: 0;
	right: 0;
	bottom: 0;
	display: flex;
	justify-content: center;
	align-items: flex-end; /* Align to bottom */
	z-index: 0; /* Lower z-index so it's behind chat-input and chat-header */
	background-color: transparent;
	pointer-events: none; /* Allow clicks to pass through */
}

/* Visual Novel Character Sprite */
.visual-novel-character-sprite {
	width: 100%;
	height: calc(100vh - 130px); /* Adjusted height to account for header */
	object-fit: contain;
	object-position: bottom center; /* Position at bottom center */
	filter: drop-shadow(0 0 10px rgba(0, 0, 0, 0.5));
	max-height: calc(100vh - 130px); /* Adjusted max-height to account for header */
	/* Remove margin-top as we're already positioning the container below header */
	transition: opacity 0.3s ease-in-out; /* Add transition for fade effect */
}

/* Sprite fade states */
.sprite-fade-in {
	opacity: 0;
	animation: fadeIn 0.3s forwards;
}

.sprite-fade-out {
	opacity: 1;
	animation: fadeOut 0.3s forwards;
}

.sprite-visible {
	opacity: 1;
}

@keyframes fadeIn {
	from {
		opacity: 0;
	}
	to {
		opacity: 1;
	}
}

@keyframes fadeOut {
	from {
		opacity: 1;
	}
	to {
		opacity: 0;
	}
}

/* Visual Novel Dialogue Box - Positioned at bottom */
.visual-novel-dialogue-box {
	width: 90%;
	max-width: 1200px;
	background-color: rgba(0, 0, 0, 0.7);
	border-radius: 10px;
	padding: 20px;
	margin-bottom: 110px; /* Increased to position above chat input */
	color: white;
	box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
	border: 2px solid #3a506b;
	z-index: 2; /* Higher z-index than the sprite but lower than chat-input */
	position: relative;
	pointer-events: auto; /* Enable interactions with the dialogue box */
}

/* Visual Novel Speaker Name */
.visual-novel-speaker {
	font-weight: bold;
	font-size: 1.2rem;
	margin-bottom: 10px;
	color: #e74c3c;
}

/* Visual Novel Text */
.visual-novel-text {
	font-size: 1.1rem;
	line-height: 1.5;
}

/* Visual Novel Message Actions - Now positioned in dialogue box */
.vn-message-actions {
	position: absolute;
	top: 10px;
	right: 10px;
	display: flex;
	gap: 10px;
	z-index: 20;
	pointer-events: auto; /* Ensure buttons are clickable */
}

/* Sprite Loading Placeholder */
.sprite-loading-placeholder {
	color: white;
	font-size: 1.2rem;
	text-align: center;
	background-color: rgba(0, 0, 0, 0.5);
	padding: 20px;
	border-radius: 10px;
}

/* Sprite Manager Modal */
.sprite-manager-modal {
	width: 90%;
	max-width: 800px;
	max-height: 90vh;
	overflow-y: auto;
}

/* Sprite Selection Grid */
.sprites-grid {
	display: grid;
	grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
	gap: 15px;
	margin-top: 20px;
}

/* Sprite Item */
.sprite-item {
	display: flex;
	flex-direction: column;
	align-items: center;
	cursor: pointer;
	padding: 10px;
	border-radius: 5px;
	background-color: #2c3e50;
	transition: all 0.2s ease;
}

.sprite-item:hover {
	background-color: #34495e;
}

.sprite-item.selected {
	background-color: #3498db;
}

/* Sprite Thumbnail */
.sprite-thumbnail {
	width: 100px;
	height: 150px;
	background-color: #1a1a2e;
	border-radius: 5px;
	overflow: hidden;
	display: flex;
	justify-content: center;
	align-items: center;
	margin-bottom: 10px;
}

.sprite-thumbnail-image {
	max-width: 100%;
	max-height: 100%;
	object-fit: contain;
}

.sprite-placeholder {
	width: 100%;
	height: 100%;
	display: flex;
	justify-content: center;
	align-items: center;
	font-size: 2rem;
	color: #95a5a6;
}

/* Sprite Label */
.sprite-label {
	font-size: 0.9rem;
	text-align: center;
	color: white;
}

/* Sprite Upload Section */
.sprite-upload-section {
	margin-top: 20px;
	padding: 20px;
	background-color: #2c3e50;
	border-radius: 5px;
}

/* Sprite Preview */
.sprite-preview {
	display: flex;
	flex-direction: column;
	align-items: center;
}

.sprite-image {
	max-width: 200px;
	max-height: 300px;
	object-fit: contain;
	margin-bottom: 15px;
}

.sprite-actions {
	display: flex;
	gap: 10px;
}

/* Sprite Upload Placeholder */
.sprite-upload {
	display: flex;
	flex-direction: column;
	align-items: center;
	padding: 20px;
	background-color: #34495e;
	border-radius: 5px;
}

.upload-placeholder {
	text-align: center;
}

/* Emotion Selection */
.emotion-selection {
	margin-bottom: 20px;
}

.emotion-selection select {
	width: 100%;
	padding: 10px;
	border-radius: 5px;
	background-color: #34495e;
	color: white;
	border: none;
}

/* Sprites Overview */
.sprites-overview {
	margin-top: 30px;
}

/* Sprites Summary in Character Form */
.sprites-summary {
	margin-bottom: 10px;
}

.sprites-description {
	font-size: 0.9rem;
	color: #95a5a6;
	margin-top: 5px;
}

/* Responsive Adjustments */
@media (max-width: 768px) {
	.visual-novel-dialogue-box {
		width: 95%;
		padding: 15px;
	}

	.sprites-grid {
		grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
	}

	.sprite-thumbnail {
		width: 80px;
		height: 120px;
	}
}

/* VN Mode Toggle Button - Ensure it's always visible */
.vn-mode-toggle-button {
	display: flex;
	align-items: center;
	justify-content: center;
	background-color: rgba(42, 42, 42, 0.7);
	color: #fff;
	border: none;
	border-radius: 4px;
	padding: 5px 10px;
	cursor: pointer;
	transition: background-color 0.2s ease;
	font-size: 0.9rem;
	opacity: 0.9; /* Always visible */
}

.vn-mode-toggle-button:hover {
	background-color: rgba(60, 60, 60, 0.8);
	opacity: 1;
}

.vn-mode-toggle-button.active {
	background-color: rgba(100, 108, 255, 0.7);
	opacity: 0.9; /* Always visible */
}

.vn-mode-toggle-button.active:hover {
	background-color: rgba(100, 108, 255, 0.9);
	opacity: 1;
}

/* Sprite Management in Character Form */
.sprite-management-section {
	margin-top: 30px;
	border-top: 1px solid #34495e;
	padding-top: 20px;
}

.sprite-actions-overlay {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background-color: rgba(0, 0, 0, 0.6);
	display: flex;
	justify-content: center;
	align-items: center;
	gap: 10px;
	opacity: 0;
	transition: opacity 0.2s ease;
	border-radius: 5px;
}

.sprite-thumbnail:hover .sprite-actions-overlay {
	opacity: 1;
}

.sprite-action-button {
	width: 30px;
	height: 30px;
	border-radius: 50%;
	border: none;
	display: flex;
	align-items: center;
	justify-content: center;
	cursor: pointer;
	font-size: 16px;
	color: white;
}

.sprite-action-button.replace-button {
	background-color: #3498db;
}

.sprite-action-button.delete-button {
	background-color: #e74c3c;
}

.sprite-action-button:hover {
	transform: scale(1.1);
}

.sprite-item {
	position: relative;
	cursor: pointer;
	transition: transform 0.2s ease;
}

.sprite-item:hover {
	transform: translateY(-5px);
}

/* Make the sprite thumbnails in character form slightly smaller */
.sprite-management-section .sprite-thumbnail {
	position: relative;
	width: 80px;
	height: 120px;
}
